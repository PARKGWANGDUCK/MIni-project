package miniProject.getLunch;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.sql.Statement;

public class DBUtils {
	private static final String DB_URL = "jdbc:mysql://localhost:3306/";
//	private static final String DRIVER_NAME = "com.mtsql.cj.jdbc.Driver"; // D만 대문자
	private static final String DATABASE_NAME = "random_lunch";
	private static final String USER = "root";
	private static final String PASSWORD = "skffkqhd831!";
	
	public static Connection getConnection() throws SQLException {
//		Connection connection = DriverManager.getConnection(DB_URL + DATABASE_NAME, USER, PASSWORD);
//		return connection;
		
//		Class.forName(DRIVER_NAME); // Driver 로딩, JDBC 4.0이후로 모든 드라이버들은 클래스패스에서 자동으로 로딩됨
		return DriverManager.getConnection(DB_URL + DATABASE_NAME, USER, PASSWORD);
		
	}
	
	public static void dropAndCreateTable() {
		
		final String dropTableQuery = "DROP TABLE IF EXISTS lunch";
		
		// Statement : Query 전달 객체
		Connection conn;
		Statement stmt;
		try {
			conn = getConnection();
			stmt = conn.createStatement();
			stmt.execute(dropTableQuery); // 진행 시켜
			
			final String createTableQuery = 
		            "CREATE TABLE lunch (" +
		            "food_id INT(5) unsigned NOT NULL AUTO_INCREMENT," +
		            "food_type CHAR(255)," +
		            "food_name CHAR(255)," +		            
		            "food_noodle BOOLEAN DEFAULT false," +
		            "food_rice BOOLEAN DEFAULT false," +
		            "food_stew BOOLEAN DEFAULT false," +
		            "PRIMARY KEY (food_id))";
			
			stmt.execute(createTableQuery);
		} catch (SQLException e) {
			e.printStackTrace();
		}
	}
	
	public static void dropAndCreateUserTable() {
			
		final String dropTableQuery = "DROP TABLE IF EXISTS profile";
			
		// Statement : Query 전달 객체
		Connection conn;
		Statement stmt;
		try {
			conn = getConnection();
			stmt = conn.createStatement();
			stmt.execute(dropTableQuery); // 진행 시켜
				
			final String createTableQuery = 
					"CREATE TABLE profile (" +
//				    "user_num INT(5) unsigned NOT NULL AUTO_INCREMENT," +
			        "user_id VARCHAR(255) PRIMARY KEY," +
			        "user_password VARCHAR(255)" +	            
			        "PRIMARY KEY (use_id))";
				
			stmt.execute(createTableQuery);
			System.out.println("end");
		} catch (SQLException e) {
			e.printStackTrace();
		}
	}
}


